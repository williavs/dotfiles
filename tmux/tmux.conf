 # Tmux Configuration

 # Enable mouse support
set -g mouse on

 # Better colors and terminal settings
set -g default-terminal "tmux-256color"
 # Enable UTF-8 (for older tmux versions)


# Pane Titles on
set -g set-titles on
set -g set-titles-string '#{pane_title}'

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# History limit
set -g history-limit 50000

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @plugin 'b0o/tmux-autoreload'
set -g @plugin 'laktak/extrakto'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'


### DISPLAY_POPUP ####

bind s display-popup -E "tmux list-sessions | sed -E 's/:.*$//' | grep -v \"^$(tmux display-message -p '#S')\$\" | fzf --reverse | xargs tmux switch-client -t"


##### Display Menu ##### 

bind d display-menu -T "#[align=centre]Dotfiles" -x C -y C \
  ".zshrc"            z  "display-popup -E 'nvim ~/.zshrc'" \
  ".tmux.conf"        t  "display-popup -E 'nvim ~/.tmux.conf'" \
  ".config/wezterm"   w  "display-popup -E 'nvim ~/.config/wezterm/wezterm.lua'" \
  "Exit"              q  ""


bind g display-popup \
  -d "#{pane_current_path}" \
  -w 80% \
  -h 80% \
  -E "lazygit"


## TUI APPS MENU

bind t display-menu -T "#[align=centre fg=cyan bold] ðŸ‘½ Which App To Open? " -x C -y C \
  "" \
  "#[fg=green]â‰ Todobi"              1  "display-popup -E -w 40% -h 80% 'todobi'" \
  "#[fg=white]â‰ Vinw Workspace"      2  "display-popup -E -w 50% -h 60% 'vinw-workspace'" \
  "#[fg=magenta]â‰ Slaygent Dashboard" 3  "display-popup -E -w 90% -h 60% 'slay'" \
  "#[fg=yellow]â‰ Claude"             4  "display-popup -E -w 70% -h 60% 'claude'" \
  "#[fg=red]â‰ GitTUI"                5  "display-popup -E -w 47% -h 100% 'gittui'" \
  "#[fg=cyan]â‰ OpenCode"             6  "display-popup -E -w 70% -h 60% 'opencode'" \
  "#[fg=blue]â‰ Crush"                7  "display-popup -E -w 70% -h 60% 'crush'" \
  "" \
  "#[fg=white dim]â˜¢ Exit"            q  ""

## BACKGROUND SWITCHER (Wezterm)
# Keybindings for dynamic Unsplash backgrounds (359 images)

bind -n M-N run-shell "~/.config/wezterm/backgrounds/switch.sh next && tmux display-message 'Next background'"
bind -n M-P run-shell "~/.config/wezterm/backgrounds/switch.sh prev && tmux display-message 'Previous background'"
bind -n M-R run-shell "~/.config/wezterm/backgrounds/switch.sh random && tmux display-message 'Random background'"
bind -n M-D run-shell "~/.config/wezterm/backgrounds/switch.sh daily && tmux display-message 'Daily background'"

# Brightness/Opacity controls
bind -n M-Up run-shell "~/.config/wezterm/backgrounds/brightness.sh brighter"
bind -n M-Down run-shell "~/.config/wezterm/backgrounds/brightness.sh darker"
bind -n M-= run-shell "~/.config/wezterm/backgrounds/brightness.sh reset && tmux display-message 'Reset brightness'"

# Background menu (prefix + b)
bind b display-menu -T "#[align=centre fg=magenta bold] â—ˆ Background Switcher " -x C -y C \
  "" \
  "#[fg=green]â†’ Next Background"       n  "run-shell '~/.config/wezterm/backgrounds/switch.sh next'" \
  "#[fg=green]â† Previous Background"   p  "run-shell '~/.config/wezterm/backgrounds/switch.sh prev'" \
  "#[fg=yellow]â—‰ Random Background"    r  "run-shell '~/.config/wezterm/backgrounds/switch.sh random'" \
  "#[fg=cyan]â—· Daily Background"       d  "run-shell '~/.config/wezterm/backgrounds/switch.sh daily'" \
  "" \
  "#[fg=blue]â˜€ Brighter"               "+" "run-shell '~/.config/wezterm/backgrounds/brightness.sh brighter'" \
  "#[fg=blue]â˜¾ Darker"                 "-" "run-shell '~/.config/wezterm/backgrounds/brightness.sh darker'" \
  "#[fg=magenta]â†» Reset Brightness"    "=" "run-shell '~/.config/wezterm/backgrounds/brightness.sh reset'" \
  "" \
  "#[fg=white dim]â—‰ Exit"              q  ""

# Popup styling
set -g popup-style "bg=default,fg=white"
set -g popup-border-style "fg=green dim"
set -g popup-border-lines "rounded"

# # message text
set-option -g message-style bg=colour235,fg=colour166 # bg=base02, fg=blue

# easy reload config
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded."

# Unbind fontpicker (not ready yet)
unbind -T prefix f

# Vim-style pane navigation
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# Vim-style pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# session navigation
bind n switch-client -n  # next session
bind p switch-client -p  # previous session

# clock and system info
set -g status-interval 1
set -g status-justify centre # center align window list
set -g status-left-length 40
set -g status-right-length 140

# Status bar styling
set -g status-position top
set -g status-style bg=colour233,fg=colour248

# Status bar - LEFT: session info
set -g status-left '#[fg=green,bold]#{session_name} #[fg=blue]| #[fg=yellow]#(whoami)@#H'

# Status bar - RIGHT: system info + time
set -g status-right '#{?#{>:#{cpu_percentage},80},#[fg=red#,bg=colour236],#{?#{>:#{cpu_percentage},50},#[fg=yellow#,bg=colour236],#[fg=cyan#,bg=colour236]}}âš™ CPU #{cpu_percentage} #[default]â”‚ #{?#{>:#{ram_percentage},80},#[fg=red#,bg=colour236],#{?#{>:#{ram_percentage},50},#[fg=yellow#,bg=colour236],#[fg=green#,bg=colour236]}}â—§ RAM #{ram_percentage} #[default]â”‚ #[fg=yellow,bg=colour236]âš¡ #{battery_percentage} #[default]â”‚ #[fg=white,bg=default]%a %l:%M:%S %p #[fg=blue]%Y-%m-%d'

# CPU plugin colors
# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
